task_name: train
tags:
- mnist
- simple_dense_net
train: true
test: true
ckpt_path: null
seed: 12345
data:
  load:
    _target_: gadme.datasets.esc50_datamodule.ESC50
    data_dir: ${paths.dataset_path}
    dataset_name: esc50
    feature_extractor_name: ${model.name_hf}
    hf_path: ashraq/esc50
    hf_name: None
    seed: ${random_seed}
    train_batch_size: ${train_batch_size}
    eval_batch_size: ${eval_batch_size}
    val_split: ${val_split}
    column_list:
    - input_values
    - target
  extras:
    num_classes: 50
  batch_size: 64
model:
  _target_: src.models.base_module.BaseModule
  override:
  - /model: default
  model:
    _target_: torchvision.models.resnet18
  compile: false
  optimizer:
    lr: 0.002
  net:
    lin1_size: 128
    lin2_size: 256
    lin3_size: 64
callbacks:
  early_stopping:
    _target_: lightning.pytorch.callbacks.EarlyStopping
    monitor: val_loss
    patience: 2
    min_delta: 0
  lr_monitor:
    _target_: lightning.pytorch.callbacks.LearningRateMonitor
    logging_interval: step
  time_tracking:
    _target_: gadme.callbacks.TimeCallback
trainer:
  _target_: lightning.pytorch.trainer.Trainer
  default_root_dir: ${paths.output_dir}
  min_epochs: 10
  max_epochs: 10
  accelerator: cpu
  devices: 1
  check_val_every_n_epoch: 1
  deterministic: false
  gradient_clip_val: 0.5
paths:
  root_dir: ${oc.env:PROJECT_ROOT}
  work_dir: ${hydra:runtime.cwd}
  output_dir: ${hydra:runtime.output_dir}
  dataset_path: ${paths.root_dir}/data_gadme
  log_dir: ${paths.output_dir}/logs/
extras:
  ignore_warnings: false
  enforce_tags: true
  print_config: true
logger:
  wandb:
    tags: ${tags}
    group: mnist
  aim:
    experiment: mnist
